<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>trannies.online</title>
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }

  html, body {
    width: 100%;
    height: 100%;
    overflow: hidden;
    background: #09090b;
  }

  .scene {
    position: relative;
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    perspective: 900px;
  }

  .logo-container {
    position: relative;
    z-index: 10;
    transform-style: preserve-3d;
    will-change: transform;
  }

  #logoCanvas {
    display: block;
    max-width: 90vw;
    max-height: 30vh;
    width: auto;
    height: auto;
    image-rendering: pixelated;
    opacity: 0;
    animation: reveal 1.6s cubic-bezier(0.16, 1, 0.3, 1) 0.4s forwards;
  }

  @keyframes reveal {
    from { opacity: 0; filter: blur(6px); transform: translateY(14px); }
    to   { opacity: 1; filter: blur(0);   transform: translateY(0); }
  }

  .cityscape {
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 45%;
    z-index: 5;
    overflow: hidden;
  }

  .city-layer {
    position: absolute;
    bottom: 0;
    left: -10%;
    width: 120%;
    will-change: transform;
  }

  .city-layer canvas { display: block; width: 100%; height: auto; }

  .horizon-fog {
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 55%;
    z-index: 6;
    pointer-events: none;
    background: linear-gradient(to top, #09090b 0%, transparent 100%);
  }

  .particles-canvas {
    position: fixed;
    inset: 0;
    z-index: 4;
    pointer-events: none;
  }

  .footer {
    position: fixed;
    bottom: 18px;
    width: 100%;
    text-align: center;
    z-index: 20;
    font-family: "Courier New", Courier, monospace;
    font-size: 11px;
    color: rgba(255, 255, 255, 0.25);
  }
</style>
</head>
<body>

<div class="scene">
  <div class="logo-container" id="logoContainer">
    <canvas id="logoCanvas"></canvas>
  </div>
  <div class="cityscape" id="cityscape"></div>
  <div class="horizon-fog"></div>
</div>

<canvas class="particles-canvas" id="particlesCanvas"></canvas>
<div class="footer">made by <a href="https://ambrosial.space" target="_blank" style="color:inherit;text-decoration:none">ambrosial</a></div>

<script>
const LOGO_ART = [
  "                                                                                                                                                      ",
  "                                                      ##                                                       mmmm         ##                        ",
  "   ##                                                 \"\"                                                       \"\"##         \"\"                        ",
  " #######    ##m####   m#####m  ##m####m  ##m####m   ####      m####m   mm#####m             m####m   ##m####m    ##       ####     ##m####m   m####m  ",
  "   ##       ##\"       \" mmm##  ##\"   ##  ##\"   ##     ##     ##mmmm##  ##mmmm \"            ##\"  \"##  ##\"   ##    ##         ##     ##\"   ##  ##mmmm## ",
  "   ##       ##       m##\"\"\"##  ##    ##  ##    ##     ##     ##\"\"\"\"\"\"   \"\"\"\"##m            ##    ##  ##    ##    ##         ##     ##    ##  ##\"\"\"\"\"\" ",
  "   ##mmm    ##       ##mmm###  ##    ##  ##    ##  mmm##mmm  \"##mmmm#  #mmmmm##     ##     \"##mm##\"  ##    ##    ##mmm   mmm##mmm  ##    ##  \"##mmmm# ",
  "    \"\"\"\"    \"\"        \"\"\"\" \"\"  \"\"    \"\"  \"\"    \"\"  \"\"\"\"\"\"\"\"    \"\"\"\"\"    \"\"\"\"\"\"      \"\"       \"\"\"\"    \"\"    \"\"     \"\"\"\"   \"\"\"\"\"\"\"\"  \"\"    \"\"    \"\"\"\"\"  ",
  "                                                                                                                                                      ",
  "                                                                                                                                                      ",
];

const logoCanvas = document.getElementById('logoCanvas');
let logoOffscreen = null;
let logoDpr = 1;
let logoPad = 0; // physical px of transparent bleed padding added to each side

function initLogo() {
  logoDpr = window.devicePixelRatio || 1;
  const fontSize = 13;
  const pad = 80; // logical px of padding on every side for shadow bleed
  logoPad = Math.round(pad * logoDpr);

  const tmp = document.createElement('canvas');
  const tmpCtx = tmp.getContext('2d');
  const fontStr = `${fontSize}px "Courier New", Courier, monospace`;
  tmpCtx.font = fontStr;
  const cw = Math.round(tmpCtx.measureText('W').width);
  const ch = Math.round(fontSize * 1.2);

  const cols = Math.max(...LOGO_ART.map(l => l.length));
  const rows = LOGO_ART.length;

  logoOffscreen = document.createElement('canvas');
  logoOffscreen.width  = cols * cw * logoDpr;
  logoOffscreen.height = rows * ch * logoDpr;
  const offCtx = logoOffscreen.getContext('2d');
  offCtx.scale(logoDpr, logoDpr);
  offCtx.font = fontStr;
  offCtx.fillStyle = '#ffffff';
  offCtx.textBaseline = 'top';
  LOGO_ART.forEach((line, row) => {
    for (let col = 0; col < line.length; col++) {
      if (line[col] !== ' ') offCtx.fillText(line[col], col * cw, row * ch);
    }
  });

  logoCanvas.width  = logoOffscreen.width  + 2 * logoPad;
  logoCanvas.height = logoOffscreen.height + 2 * logoPad;
  logoCanvas.style.width  = (cols * cw + 2 * pad) + 'px';
  logoCanvas.style.height = (rows * ch + 2 * pad) + 'px';
  logoCanvas.style.margin = `-${pad}px`;
}

function drawLogoWithLight() {
  if (!logoOffscreen) return;
  const ctx = logoCanvas.getContext('2d');
  ctx.clearRect(0, 0, logoCanvas.width, logoCanvas.height);

  const cursorX = mouseX * window.innerWidth;
  const cursorY = mouseY * window.innerHeight;

  const rect  = logoCanvas.getBoundingClientRect();
  const lx    = rect.left + rect.width  * 0.5;
  const ly    = rect.top  + rect.height * 0.5;

  // basically light direction
  const vx   = cursorX - lx;
  const vy   = cursorY - ly;
  const dist = Math.hypot(vx, vy) || 1;
  const nx   = vx / dist;  // +1 = cursor is right of logo
  const ny   = vy / dist;

  const maxDist = Math.hypot(window.innerWidth, window.innerHeight) * 0.55;
  const t = Math.min(dist / maxDist, 1);

  const maxOff = 20 * logoDpr;
  const gx = nx * maxOff * t;
  const gy = ny * maxOff * t;

  ctx.save();
  ctx.shadowColor   = `rgba(200, 110, 255, ${0.4 + t * 0.55})`;
  ctx.shadowBlur    = (14 + t * 22) * logoDpr;
  ctx.shadowOffsetX = gx;
  ctx.shadowOffsetY = gy;
  ctx.drawImage(logoOffscreen, logoPad, logoPad);
  ctx.restore();

  ctx.save();
  ctx.shadowColor   = `rgba(240, 200, 255, ${0.55 + t * 0.45})`;
  ctx.shadowBlur    = 4 * logoDpr;
  ctx.shadowOffsetX = gx * 0.35;
  ctx.shadowOffsetY = gy * 0.35;
  ctx.drawImage(logoOffscreen, logoPad, logoPad);
  ctx.restore();

  ctx.drawImage(logoOffscreen, logoPad, logoPad);
}

initLogo();

let mouseX = 0.5, mouseY = 0.5;
let targetX = 0.5, targetY = 0.5;

document.addEventListener('mousemove', e => {
  targetX = e.clientX / window.innerWidth;
  targetY = e.clientY / window.innerHeight;
});

const logoEl = document.getElementById('logoContainer');

function updateLogo() {
  const dx = mouseX - 0.5, dy = mouseY - 0.5;
  logoEl.style.transform =
    `rotateX(${dy * -8}deg) rotateY(${dx * 12}deg)`;
}

function buildLayer(color, minH, maxH, bwRange, gapRange, yOff, id) {
  const cvs = document.createElement('canvas');
  cvs.width = 2400; cvs.height = 500;
  const ctx = cvs.getContext('2d');
  ctx.fillStyle = color;
  let x = 0;
  while (x < cvs.width) {
    const bw = bwRange[0] + Math.random() * (bwRange[1] - bwRange[0]);
    const bh = minH + Math.random() * (maxH - minH);
    const gap = gapRange[0] + Math.random() * (gapRange[1] - gapRange[0]);
    ctx.fillRect(x, 500 - bh, bw, bh);
    if (bh > maxH * 0.7 && Math.random() > 0.5) {
      const aw = 1 + Math.random() * 2, ah = 10 + Math.random() * 30;
      ctx.fillRect(x + bw / 2 - aw / 2, 500 - bh - ah, aw, ah);
    }
    if (bh > 40) {
      const wc = color === '#0d0d10' ? 'rgba(255,255,255,0.05)'
               : color === '#141418' ? 'rgba(255,255,255,0.035)'
               : 'rgba(255,255,255,0.02)';
      ctx.fillStyle = wc;
      for (let wy = 500 - bh + 8; wy < 492; wy += 12)
        for (let wx = x + 4; wx < x + bw - 4; wx += 8)
          if (Math.random() > 0.6) ctx.fillRect(wx, wy, 3, 5);
      ctx.fillStyle = color;
    }
    x += bw + gap;
  }
  const div = document.createElement('div');
  div.className = 'city-layer'; div.id = id;
  div.style.bottom = yOff + 'px';
  div.appendChild(cvs);
  return div;
}

const cityscape = document.getElementById('cityscape');
function buildCity() {
  cityscape.innerHTML = '';
  cityscape.appendChild(buildLayer('#141418', 80, 260, [20,50], [3,12], 40, 'lFar'));
  cityscape.appendChild(buildLayer('#111115', 50, 180, [15,40], [4,15], 20, 'lMid'));
  cityscape.appendChild(buildLayer('#0d0d10', 30, 120, [12,35], [5,18],  0, 'lNear'));
}
buildCity();

function updateCity() {
  const ox = mouseX - 0.5, oy = mouseY - 0.5;
  document.getElementById('lFar').style.transform  = `translateX(${ox*-30}px) translateY(${oy*-8}px)`;
  document.getElementById('lMid').style.transform  = `translateX(${ox*-55}px) translateY(${oy*-14}px)`;
  document.getElementById('lNear').style.transform = `translateX(${ox*-85}px) translateY(${oy*-20}px)`;
}

const pcvs = document.getElementById('particlesCanvas');
const pctx = pcvs.getContext('2d');
function resize() { pcvs.width = innerWidth; pcvs.height = innerHeight; }
resize();
window.addEventListener('resize', () => { resize(); buildCity(); initLogo(); });

class P {
  constructor() { this.reset(); }
  reset() {
    this.x = Math.random() * pcvs.width;
    this.y = Math.random() * pcvs.height;
    this.r = 0.4 + Math.random() * 1.2;
    this.vx = (Math.random() - 0.5) * 0.2;
    this.vy = -0.08 - Math.random() * 0.3;
    this.a = 0.08 + Math.random() * 0.22;
    this.life = 0;
    this.max = 400 + Math.random() * 600;
    this.ws = 0.002 + Math.random() * 0.004;
    this.wa = 0.3 + Math.random() * 0.6;
  }
  update() {
    this.x += this.vx + Math.sin(this.life * this.ws) * this.wa + (mouseX - 0.5) * 0.3;
    this.y += this.vy;
    this.life++;
    const t = this.life / this.max;
    this.ca = t < 0.15 ? this.a * (t / 0.15)
             : t > 0.75 ? this.a * (1 - (t - 0.75) / 0.25)
             : this.a;
    if (this.life >= this.max || this.y < -10) { this.reset(); this.y = pcvs.height + 10; }
  }
  draw() {
    pctx.beginPath();
    pctx.arc(this.x, this.y, this.r, 0, Math.PI * 2);
    pctx.fillStyle = `rgba(255,255,255,${this.ca})`;
    pctx.fill();
  }
}

const pts = Array.from({length: 90}, () => new P());

function drawParticles() {
  pctx.clearRect(0, 0, pcvs.width, pcvs.height);
  pts.forEach(p => { p.update(); p.draw(); });
}

function animate() {
  mouseX += (targetX - mouseX) * 0.05;
  mouseY += (targetY - mouseY) * 0.05;
  updateLogo();
  drawLogoWithLight();
  updateCity();
  drawParticles();
  requestAnimationFrame(animate);
}
animate();
</script>
</body>
</html>